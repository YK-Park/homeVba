'word target tool prompt
시트A(”単語リスト”)에는 ３０００個の후보단어들이 있다.  
A열 급넘버, B열 유니크넘버, C:열 급, D열 타겟단어, E열 품사, F열 출제구분이 있다.
시트B("ターゲット候補")의 A열에 타겟단어를 입력하면(200個以上), 
시트A의 D열에서 타겟단어를 검색하여,
타겟단어와 완전히 다른 어근을 가진 단어들은 포함
타겟단어와 같은 단어, 타겟단어의 파생어/다른 품사, 같은 stem을 가진 단어들을 제외하고　표시해주는 툴을 만들고 싶다.
예를 들면 surprise 를 입력하면, be surprised at 와 같은 단어들을 제외해야 한다.

結果はシートBのC列からH列まで表示される。
このシートにあるA列の単語と比較した結果単語はF列に表示される。
F列に表示される単語が単語リストシートから検索した単語で、上の条件を満たす単語だ。

ｃ列にはその単語がある行の単語リストシートのA列のデータを表示する。
同じようにD,E,G,H列にもその単語がある行の単語リストシートのB,C,E,F列のデータが表示される。

そして、結果の単語はA列の全単語とかぶらないし、F列の単語同士もかぶらないようにする。

A列の単語を単語リストシートから検索し、同じ単語と同じ語幹の単語を除外することと、
結果として表示されるF列の単語同士も同じ単語と同じ語幹の単語を除外する処理をする

F列の結果の単語同士を比較で同じ語幹の単語は一番短い単語を残して他は削除。
ただ行削除ではなく、セルのclearContentsを利用

これのために、
まず、語幹を取得するようにsuffixes削除し、その前までを取得する。


例えば、シートCを用意し、シートBのA列の単語をコピーし、Aにペーストして、B列にはその語幹を記録する
そしてその二つをシートAの単語と比較しそれと同じ単語、またはそれと同じ語幹の単語以外の単語を
シートCのC列に表示する。
そのあと、シートCのC列の単語の語幹を取得しシートCのD列に表示する
そのあと、シートCのC列の単語から、同じ単語と同じ語幹の単語を削除する。
ただ、同じ語幹の単語は１個短いほうを残す。

語幹の判断のためには、stemmer関数を利用してsuffixes削除した単語同士のlevenshteinDistanceを利用しようかと思う。

ただ、中には句動詞もあり、一つのセルに複数の単語がある場合がある。
その場合も、同じ単語や同じ語幹を持っていることを判断したい。

다시 정리하면 
이전 대화에서 우리는 단어의 어근(stem)을 분석하고 비교하는 VBA 코드를 작성했습니다. 코드의 주요 기능은:
1. 단어에서 접미사를 제거하여 어근을 찾는 GetStem 함수
2. 레벤슈타인 거리를 사용하여 두 단어의 유사도를 계산하는 CalculateSimilarity 함수
3. 두 단어가 같은 어근을 가지는지 확인하는 HasSameStem 함수
4. 메인 프로세스를 실행하는 ProcessWords 서브루틴
이 코드는 다음과 같은 4단계로 실행됩니다:
1. 대상 단어 목록을 복사하고 각 단어의 어근을 추출
2. 기존 단어 목록과 비교하여 중복되지 않는 단어 찾기
3. 결과 단어들의 어근 추출
4. 같은 어근을 가진 단어들 중 가장 짧은 단어만 남기기

숙어와 단어 비교 시:
숙어를 단어로 분리
각 단어와 단일 단어를 비교
하나라도 일치하면 True 반환

숙어끼리 비교 시:
완전 일치만 True 반환

단어끼리 비교 시:
기존 로직대로 처리

그런데 C시트에 기록한 이유는 과정을 확인하고 싶어서였기 떄문에 
이제 기록은 안해도 된다. 

로직은 동일하게 하면서, B시트의 A열에 있는 단어들과 A시트의 후보단어들과 비교한 결과
그리고 그 결과간의 비교를 통해 위에서 말한 조건을 만족시키는 결과를 얻고 싶다. 
결과는 B시트의 C~H에 표시하는데, A시트에서 얻은 결과단어의 해당단어의 A~F에 있는 정보까지 가져오게 하고 싶다. 

그리고 결과를 조정하기 위해서
HasSameStem = (CalculateSimilarity(stem1Final, stem2Final) >= 0.8)이 부분에서 0.8을 변경해가면 좋지 않을까 하는데
그래서 B시트의 B1에 기입된 값을 받아 처리하는 방식으로 하면 좋겠다.

그리고, 결과표기에서 startRow를 2로 하고 있는데, 버튼등의 설치를 위해 3으로 조정하고 싶다.

