'word target tool prompt
일본판 엑셀로 영어단어 검색툴을 만들고 싶다.
시트(”単語リスト”)에는 후보단어들이 있다.  
A열에는 급넘버, B열에는 유니크넘버, C열에는 급, D열에는 타겟단어가 있고, E열에는 품사, F열에는 출제구분이 나와있다.
시트("ターゲット候補")의 D1에 타겟단어를 입력하면, 
単語リスト시트의 D열에서 타겟단어를 검색하여,
타겟단어와 같은 단어, 비슷한 단어, 그 단어의 다른 품사인 단어들을 제외하고,
다른 단어를 표시해주는 툴을 만들고 싶다.
예를 들면 surprise 를 입력하면, be surprised at 와 같은 단어들을 제외해야 한다.
하지만 예를 들어 discourage 를 입력했을 때, encourage는 표시되어야 한다.
単語リスト시트의 D열에서 타겟단어를 입력하면, 
6번 줄부터 나타나도록 하고 싶다.
결과에서도 같은 stem을 가진 단어들은 제외하고 싶다. 
예를 들어 만일 apparent가 결과로 표시된다면 apparently는 표시되지 말아야 한다.

타겟단어를 원형만 입력하고,
검색대상이 되는 리스트에서 원형보다 짧은 단어는 유사한 단어가 될 수 없는 것 아닌가? 
예를 들어 satisfy를 입력하여, 그 단어의 변형 또는 다른 품사는 제외하면  be satisfied with 는 제외될텐데,
이때 be를 제외한다던지 하는 것이 아니라, be satisfied with의 가장 긴 단어인 satisfied와만 비교하여 
다른 품사에 해당되므로 제외할 수 있다면 덜 복잡해지지 않을까?

COMMON_SUFFIXES를 사용하다보니 자꾸 에러가 나는 것 같다.
stemword를 사용하고 있기도 하니, 그것만 이용해서도 원하는 결과를 얻을 수 있지 않을까?
그리고 지금은 D2에 비교를 원하는 단어를 쓰고, j열부터 결과가 나오게 하고 있지만,
그것보다 효율적인 UI가 있을 것 같다. 
한단어씩 비교를 하려고 하는 것이니 보다 더 효율적인 방법으로 어떤 것이 좋을지 알려줘



첨부한 코드는 이하의 프롬프트를 만족시키는 하나의 방식으로 만든 것이다.

타겟단어와 완전히 다른 어근을 가진 단어들과
 접두사만 다른 관련 단어들(의미 유사도는 고려하지 않음)은 포함
 타겟단어와 같은 단어,
 타겟단어의 파생어/다른 품사
 같은 stem을 가진 단어
 접두사가 달라도 의미가 거의 같은 단어들은 제외




SearchRelatedWords (메인 함수)
CompareWords (단어 비교)
HasCommonPrefix (공통 접두사 확인)
RemovePrefix (접두사 제거)
FilterDerivatives (파생어 필터링)
PorterStemmer (포터 스테밍 알고리즘)
ContainsVowel (모음 포함 여부 확인)
IsDoubleConsonant (이중 자음 확인)
MeasureVC (모음-자음 시퀀스 수 측정)
IsVowel (모음 여부 확인)